'start_alarm':
  alias: Alarm start
  sequence:
  - service: script.turn_on
    data:
      entity_id: script.alarm_sound_loop
  - service: xiaomi_aqara.play_ringtone
    data:
      gw_mac: !secret aquara_mac
      ringtone_id: 0
      ringtone_vol: 100
      # ringtone_vol: 3
  - service: notify.pushbullet_notify
    data_template:
      title: Þjófavörn!!
      message: 'Þjófavörn fór í gang !'


'stop_alarm':
  alias: Alarm Stop
  sequence:
  # - service: script.turn_off
  #   data:
  #     entity_id: script.alarm_sound_loop, alarm_sound
  - service: xiaomi_aqara.stop_ringtone
    data:
      gw_mac: !secret aquara_mac


'alarm_sound':
  alias: Alarm mini
  sequence:
  - condition: state
    entity_id: alarm_control_panel.home_alarm
    state: 'triggered'
  - service: media_player.turn_on
    data:
      entity_id: media_player.google_mini_kitchen_speaker
  - delay:
      seconds: 2
  - service: media_player.volume_set
    data:
      entity_id:  media_player.google_mini_kitchen_speaker
      volume_level: '1.00'
      # volume_level: '0.02'
  - delay:
      seconds: 1
  - service: media_player.play_media
    data:
      entity_id: media_player.google_mini_kitchen_speaker
      media_content_id: http://www.raypinson.com/ringtones/alarm2.mp3
      media_content_type: 'audio/mp3'
  - delay:
      seconds: 5   
  - service: script.turn_on
    data:
      entity_id: script.alarm_sound_loop

'alarm_sound_loop':
  alias: Alarm mini loop
  sequence:
  # - delay:
  #     # time for flash light off
  #     seconds: 2
  - service: script.turn_on
    data:
      entity_id: script.alarm_sound

  #Flasha ljósum
  # Kveikja á mini og hækka áður en loopuni er startað?


# 'good_night_lights':
#   alias: Good night light
#   sequence:
#   - service: light.turn_off
#     data:
#       entity_id:
#       - light.gangur
#       - light.forstofa
#       # Elisabet shelly
#       - light.hjonaherbergi_gangur
#       transition: 5
#   - service: light.turn_on
#     data:
#       entity_id:
#       - light.stofa
#       - light.eldhus
#       - light.stigi
#       brightness: 50
#       transition: 5
#   # Waits 1 minute, 30 seconds
#   - delay: '00:01:30'
#   - service: light.turn_off
#     data:
#       entity_id:
#       - light.stofa
#       - light.eldhus
#       - light.hjonaherbergi_gangur
#       transition: 10

'test_brightness_script':
  alias: test brightness script
  sequence:
  - service: script.set_brightness_if_on
    data:
      light_id: 'stofa'
      brightness: 1


# Set brightness if on 
'set_brightness_if_on':
  alias: Set brightness if on
  sequence:
  - condition: template
    value_template: 'light.{{light_id}}.state == "on"'
    # value_template: "{{ states(light.{{light_id}}) == 'on' }}"
  - service: light.turn_on
    data_template:
      entity_id: 'light.{{light_id}}'
      brightness: '{{brightness}}'